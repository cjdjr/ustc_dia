# 匹配几何校验

学号：SA20006150 

姓名：汪敏瑞



## 任务描述

- 给定一对图像，利用提取好的SIFT特征文件，根据距离阈值准则（跨图像的局部SIFT特征距离小于0.4，该阈值可自行调整），得到图像间的初始局部特征匹配关系
- 基于上述初步匹配结果，实现spatial coding方法，进行匹配校验，确定几何不一致的匹配
- 将几何一致的匹配和不一致的匹配在图像上画出来，分别用蓝色和红色进行区分
- 在本实验中采取python作为实验代码



## 算法过程

* 寻找匹配对
  * 根据sift描述子的距离寻找并提取第1张图与第2张图的SIFT描述⼦匹配对的 (x，y) 坐标点集（实验中阈值取0.2），分别放进map1和map2中。
* 生成空间映射
  * 根据map1，map2每个点相对其他点坐标的左右上下位置关系，以及 k种（本实验中取k=4）旋转角度，⽣成由0、1构成的维数为（对应点数对应点数k）的空间编码矩阵GX1，GY1，GX2，GY2中。
* 计算不⼀致性矩阵
  * 将空间编码矩阵GX1与GX2，GY1与GY2进⾏异或操作得到不⼀致性矩阵Vx，Vy。
  * 计算不⼀致性总和Sx，Sy，即矩阵Vx，Vy各⾏元素求和，再对k个⽅向各⾏元素和求总和，得到Sx，Sy。
* 检查Sx，Sy，识别错误匹配项
  * 首先基于Vx，计算Sx，找到对应的ix, 然后从Vx和Vy中把对应的第i行、第i列mask掉（本实验中以置零方式进⾏mask），随后立即更新连线。
  * 然后基于更新后的Vy，计算Sy，找到对应的jx, 然后从Vx和Vy中把对应的第j⾏、
    第j列全部mask掉（本实验中以置零方式进⾏mask），随后⽴即更新连线。
  * 对更新后的Vx和Vy重复上面两步，直到收敛（本实验取不⼀致性总和的阈值为（0.8*匹配对
    数）取整）。  



## 实验结果

红色代表错误的匹配，蓝色代表正确的匹配

![image-20210516220512644](C:\Users\chelly\AppData\Roaming\Typora\typora-user-images\image-20210516220512644.png)

![image-20210516223243592](C:\Users\chelly\AppData\Roaming\Typora\typora-user-images\image-20210516223243592.png)

![image-20210516223345059](C:\Users\chelly\AppData\Roaming\Typora\typora-user-images\image-20210516223345059.png)
